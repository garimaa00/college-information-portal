{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Set Exam Routine - ShankerDev Campus{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-sm mt-4">
            <div class="card-body">
                <h2 class="card-title text-center mb-4">Set Exam Routine</h2>

                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}

                    {% if form.non_field_errors %}
                    <div class="alert alert-danger">{{ form.non_field_errors|join:", " }}</div>
                    {% endif %}


                    <div class="card-body">
                        <div class="mb-3">
                            <label for="{{ form.semester.id_for_label }}" class="form-label">Select Semester</label>
                            {% render_field form.semester class+="form-control" %}
                            <div class="form-text text-muted">Target this routine for a specific semester group.
                            </div>
                            {% if form.semester.errors %}<div class="text-danger small">{{
                                form.semester.errors|join:", " }}</div>{% endif %}
                        </div>
                        <div class="mb-3">
                            <label for="{{ form.title.id_for_label }}" class="form-label">Routine Title</label>
                            {% render_field form.title class+="form-control" %}
                        </div>
                        <div class="mb-3">
                            <label for="{{ form.details.id_for_label }}" class="form-label">Description</label>
                            {% render_field form.details class+="form-control" rows="3" %}
                            <div class="form-text text-muted">Additional details about the exam routine.</div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.start_date.id_for_label }}" class="form-label">Start
                                    Date</label>
                                {% render_field form.start_date class+="form-control" %}
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.end_date.id_for_label }}" class="form-label">End Date</label>
                                {% render_field form.end_date class+="form-control" %}
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="{{ form.file.id_for_label }}" class="form-label">Upload Image/File</label>
                            {% render_field form.file class+="form-control" %}
                            <div class="form-text text-muted">Upload the exam routine image or PDF.</div>
                            {% if form.file.errors %}<div class="text-danger small">{{ form.file.errors|join:", " }}
                            </div>{% endif %}
                        </div>
                    </div>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-dark btn-lg">Save Routine</button>
            </div>
            </form>
        </div>
    </div>
</div>
</div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const today = new Date().toISOString().split('T')[0];
        const startDateInput = document.getElementById('id_start_date');
        const endDateInput = document.getElementById('id_end_date');

        if (startDateInput) {
            startDateInput.setAttribute('min', today);

            startDateInput.addEventListener('change', function () {
                if (endDateInput) {
                    endDateInput.setAttribute('min', this.value);
                    if (endDateInput.value && endDateInput.value < this.value) {
                        endDateInput.value = this.value;
                    }
                }
            });
        }

        if (endDateInput) {
            endDateInput.setAttribute('min', today);
        }
    });
</script>
{% endblock %}